# Privilege Escalation

## Scripts

* [linuxprivchecker](https://github.com/sleventyeleven/linuxprivchecker)
* [LinEnum](https://github.com/rebootuser/LinEnum)
* [http://pentestmonkey.net/tools/audit/unix-privesc-check](http://pentestmonkey.net/tools/audit/unix-privesc-check)
* linux-exploit-suggester.py
* [https://github.com/lucyoa/kernel-exploits](https://github.com/lucyoa/kernel-exploits)
* [https://github.com/TH3xACE/SUDO\_KILLER](https://github.com/TH3xACE/SUDO\_KILLER)

## Articles

* [https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/](https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/)
* [https://github.com/sagishahar/lpeworkshop](https://github.com/sagishahar/lpeworkshop)

## Manual

```
# Current user and hostname
whoami
id
hostname

# Existing users
cat /etc/passwd

# OS version & architecture
cat /etc/issue
cat /etc/*-release
uname -a
arch

# Processes & services
ps aux

# Networking info
ip a
/sbin/route
ss -anp

# Firewall
cat /etc/iptables
# check for iptables-save and iptables-restore commands. See if the dump file has weak permissions

# Scheduled tasks
# verify cron files permissions and content, if possible
ls -lah /etc/cron*
cat /etc/crontab
grep "CRON" /var/log/cron.log

# Installed applications
dpkg -l
which awk perl python ruby gcc cc vi vim nmap find netcat nc wget tftp ftp 2>/dev/null

# Check for readable/writable files & directories
find / -writable -type d 2>/dev/null

# Enumerate unmounted disks
cat /etc/fstab
mount
/bin/lsblk

# List device drivers & kernel modules
lsmod
/sbin/modinfo <name>

# Check for binaries that autoelevate
# search for binaries with SUID bit
find / -perm -u=s -type f 2>/dev/null
find / -user root -perm -002 -type f -not -path "/proc/*" Â 2>/dev/null

# Check SSH config
cat /etc/ssh/sshd_config

# Check various places for stuff
/var
/opt
/usr/local/src
/usr/src
/home
```
